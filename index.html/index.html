<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Form</title>
  <style>
    body {
      background: black;
      color: #aaa;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
    }

    p {
      font-size: 24px;
      margin-bottom: 30px;
      text-align: center;
    }

    .outer-box {
      background: #0a0f30; /* dark navy border */
      border-radius: 0; /* straight corners */
      padding: 8px; /* outer border thickness */
      display: inline-block;
      margin: 20px auto;
    }

    .outer-box input {
      background: #121830; /* darker grayish-blue inner box */
      color: #aaa;
      border: none;
      padding: 25px;
      font-size: 20px;
      width: 320px;  /* slightly smaller than outer box */
      height: 70px;  /* taller vertically */
      outline: none;
      box-sizing: border-box;
    }

    button {
      background: #555;
      color: #aaa;
      border: 2px solid #888; /* gray border */
      border-radius: 5px;
      padding: 25px 45px; /* taller but shorter horizontally */
      font-size: 20px;
      cursor: pointer;
      margin-top: 30px;
    }

    #message {
      margin-top: 25px;
      color: #aaa;
      font-size: 20px;
      text-align: center;
    }
  </style>
</head>
<body>

<p>How long did it take him to smile?</p>

<div class="outer-box">
  <input type="text" id="box1">
</div>

<br>

<div class="outer-box">
  <input type="text" id="box2">
</div>

<br>

<button id="submitBtn"></button>
<p id="message"></p>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA6CxVBm-kw7FcYho3-ajLe0JpSlOaWI98",
    authDomain: "how-long-did-it-take-to-smile.firebaseapp.com",
    projectId: "how-long-did-it-take-to-smile",
    storageBucket: "how-long-did-it-take-to-smile.appspot.com",
    messagingSenderId: "206169272440",
    appId: "1:206169272440:web:03208a7c05b26ee8147d8d",
    measurementId: "G-VE0LZRLPM4"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const box1 = document.getElementById("box1");
  const box2 = document.getElementById("box2");
  const submitBtn = document.getElementById("submitBtn");
  const message = document.getElementById("message");

  let clickCounter = 0;
  let lastPermutation = "";

  // Save input on blur
  box1.addEventListener("blur", async () => {
    const val = box1.value.trim();
    if(val) {
      try {
        await addDoc(collection(db, "inputs"), {
          box: "box1",
          value: val,
          timestamp: Date.now()
        });
      } catch(e) { console.error("Error saving Box1:", e); }
    }
  });

  box2.addEventListener("blur", async () => {
    const val = box2.value.trim();
    if(val) {
      try {
        await addDoc(collection(db, "inputs"), {
          box: "box2",
          value: val,
          timestamp: Date.now()
        });
      } catch(e) { console.error("Error saving Box2:", e); }
    }
  });

  // Submit button logic
  submitBtn.addEventListener("click", () => {
    const val1 = box1.value.trim();
    const val2 = box2.value.trim();
    let perm = "";

    const valid1 = val1 === "@depedmarikina.ph" || val1 === "@gmail.com";
    const valid2 = val2.length > 0;

    if(!valid1 && !valid2) perm = "t1t2unsat";
    else if(!valid1 && valid2) perm = "t1unsat_t2sat";
    else if(valid1 && !valid2) perm = "t1sat_t2unsat";
    else perm = "t1t2sat";

    if(perm !== lastPermutation) clickCounter = 0;
    lastPermutation = perm;
    clickCounter++;

    if(clickCounter >= 10) message.textContent = "Leave.";
    else if(perm === "t1t2unsat") {
      if(clickCounter === 3) message.textContent = "Do you even exist?";
      else if(clickCounter === 5) message.textContent = "Then there's nothing for you here.";
      else message.textContent = "Unknown.";
    } else if(perm === "t1unsat_t2sat") {
      if(clickCounter === 5) message.textContent = "Your E-mail.";
      else if(clickCounter === 3) message.textContent = "But where to go?";
      else message.textContent = "Unknown Answer.";
    } else if(perm === "t1sat_t2unsat") {
      if(clickCounter === 5) message.textContent = "Answer the question.";
      else if(clickCounter === 3) message.textContent = "Nothing to say?";
      else message.textContent = "Unknown Destination.";
    } else if(perm === "t1t2sat") {
      message.textContent = "Thank you.";
      box1.value = "";
      box2.value = "";
    }
  });
</script>

</body>
</html>
